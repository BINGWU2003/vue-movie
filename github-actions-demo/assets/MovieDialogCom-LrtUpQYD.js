import{r as n,ag as N,o as S,c as y,f as l,w as i,k as E,d as I,e as f,aM as U,t as C}from"./index-BtiZJA6V.js";import{E as D}from"./el-dialog-C6nSDiPf.js";import{g as R}from"./BaseTableCom-DPhfIgH9.js";import{E as A}from"./el-button-BkswBdMW.js";import{a as L,E as M}from"./el-form-item-DnEKQG3Y.js";import{E as x}from"./el-input-DQWJxFHl.js";import{P as B}from"./PreviewPictureCom-1_33dq-R.js";import"./index-D8AN6Cr_.js";import"./el-switch-Ch1tqv_s.js";import"./event-NTjbwY5A.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./http-uaPK1vfr.js";import"./_initCloneObject-C3mgaNU_.js";import"./isEqual-QJ1JA930.js";import"./_baseClone-dr7Cctac.js";import"./tencentCloud-DYilJfO5.js";const P={class:"movie-dialog"},q={class:"dialog-footer"},oe={__name:"MovieDialogCom",props:{title:{type:String,default:"默认值"},currentRow:{type:Object},movieDialogVisible:{type:Boolean}},emits:["addMovie","editMovie","update:movieDialogVisible"],setup(_,{emit:k}){const s=n(null),v=n(null),e=n({movieName:"",movieAuthor:"",movieLink:"",checkStatus:"uncheck",movieImageFile:null}),h=n({movieName:[{required:!0,message:"请输入电影名",trigger:"blur"}],movieAuthor:[{required:!0,message:"请输入电影作者",trigger:"blur"}],movieLink:[{required:!0,message:"请输入电影链接",trigger:"blur"}],movieImageFile:[{validator:(m,t,a)=>{t?a():a(new Error("请选择图片"))},trigger:"blur"}]}),o=_,p=N({get:()=>o.movieDialogVisible,set:m=>c("update:movieDialogVisible",m)}),c=k,V=()=>{const m=s.value.fileFn().getFile(),t=s.value.imageUrlFn().getImageUrl();e.value.movieImageFile=m.value?m.value:t.value,v.value.validate().then(()=>{if(o.title==="修改电影"){const{checkStatus:{tagName:r}}=o.currentRow;r==="审核未通过"?e.value.checkStatus="blockCheck":r==="审核通过"?e.value.checkStatus="passCheck":r==="待审核"&&(e.value.checkStatus="uncheck")}const a={...e.value};o.title==="新增电影"?c("addMovie",a,m.value):o.title==="修改电影"&&c("editMovie",a,m.value)}).catch(()=>{})},b=()=>{if(v.value.clearValidate(),s.value.fileFn().setFile(null),o.title==="新增电影")s.value.imageUrlFn().setImageUrl(""),e.value.movieName="",e.value.movieAuthor="",e.value.movieLink="";else{const{movieName:m,movieAuthor:t,movieImage:a,movieLink:r,checkStatus:d}=o.currentRow;s.value.imageUrlFn().setImageUrl(a),e.value.movieName=m,e.value.movieAuthor=t,e.value.movieLink=r,e.value.checkStatus=d.tagName}};return(m,t)=>{const a=L,r=x,d=R,w=M,g=A,F=D;return S(),y("div",P,[l(F,{modelValue:p.value,"onUpdate:modelValue":t[4]||(t[4]=u=>p.value=u),title:o.title,width:"500",onOpen:b},{footer:i(()=>[E(I("div",q,[l(g,{onClick:t[3]||(t[3]=u=>p.value=!1)},{default:i(()=>[f("取消")]),_:1}),l(g,{type:"primary",onClick:V},{default:i(()=>[f(" 确认 ")]),_:1})],512),[[U,o.title!=="查看电影"]])]),default:i(()=>[l(w,{"label-width":"100px",model:e.value,rules:h.value,style:{"max-width":"460px"},ref_key:"formRef",ref:v},{default:i(()=>[l(a,{label:"电影图片",prop:"movieImageFile"},{default:i(()=>[l(B,{ref_key:"previewPictureComRef",ref:s},null,512)]),_:1}),l(a,{label:"电影名",prop:"movieName"},{default:i(()=>[l(r,{modelValue:e.value.movieName,"onUpdate:modelValue":t[0]||(t[0]=u=>e.value.movieName=u)},null,8,["modelValue"])]),_:1}),l(a,{label:"电影作者",prop:"movieAuthor"},{default:i(()=>[l(r,{modelValue:e.value.movieAuthor,"onUpdate:modelValue":t[1]||(t[1]=u=>e.value.movieAuthor=u)},null,8,["modelValue"])]),_:1}),l(a,{label:"电影链接",prop:"movieLink"},{default:i(()=>[l(r,{modelValue:e.value.movieLink,"onUpdate:modelValue":t[2]||(t[2]=u=>e.value.movieLink=u)},null,8,["modelValue"])]),_:1}),l(a,{label:"审核状态"},{default:i(()=>[l(d,{type:o.title==="新增电影"?"warning":o.currentRow.checkStatus.tagType},{default:i(()=>[f(C(o.title==="新增电影"?"待审核":o.currentRow.checkStatus.tagName),1)]),_:1},8,["type"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}};export{oe as default};
